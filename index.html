<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Capy Caf√© ‚òï</title>
<style>
  /* === –û–±—â–∏–µ —Å—Ç–∏–ª–∏ === */
  body {
    margin:0;
    padding:0;
    font-family: Arial, sans-serif;
    overflow: hidden;
    background: url('bg2.png') no-repeat center center;
    background-size: cover;
  }

  /* === –î–µ–Ω—å–≥–∏ –∏ –∑–≤–µ–∑–¥—ã === */
  #topBar {
    position: absolute;
    top: 10px; left: 10px;
    font-size: 24px;
    color: #fff;
    display: flex;
    gap: 20px;
    z-index: 100;
  }

  #money { font-weight: bold; }
  #stars { font-weight: bold; }

  /* === –ö–ª–∏–µ–Ω—Ç === */
  .client {
    position: absolute;
    bottom: 0;
    opacity: 0;
    transition: opacity 0.5s, transform 0.5s;
  }

  .client.show { opacity: 1; transform: translateY(0); }

  /* === –û–±–ª–∞—á–∫–æ –∑–∞–∫–∞–∑–∞ === */
  .orderBubble {
    position: absolute;
    bottom: 150px;
    left: 50%;
    transform: translateX(-50%) translateY(50px);
    background: rgba(255,255,255,0.9);
    border-radius: 20px;
    padding: 10px 20px;
    font-size: 18px;
    white-space: nowrap;
    opacity: 0;
    transition: opacity 0.5s, transform 0.5s;
  }
  .orderBubble.show { opacity: 1; transform: translateX(-50%) translateY(0); }

  /* === –ö–Ω–æ–ø–∫–∏ –ø—Ä–∏–Ω—è—Ç—å/–æ—Ç–∫–ª–æ–Ω–∏—Ç—å === */
  #actionButtons {
    position: absolute;
    bottom: 20px;
    right: 20px;
    display: flex;
    gap: 10px;
    z-index: 100;
  }
  #actionButtons img {
    width: 80px;
    cursor: pointer;
    transition: transform 0.2s;
  }
  #actionButtons img:hover { transform: scale(1.1); }

  /* === –ê—á–∏–≤–∫–∏ –≤—Å–ø–ª—ã–≤–∞—é—â–µ–µ –æ–∫–Ω–æ === */
  #achievementPopup {
    position: fixed;
    top: 50%; left: 50%;
    transform: translate(-50%, -50%);
    background: rgba(255,255,255,0.95);
    border-radius: 20px;
    padding: 20px 40px;
    font-size: 24px;
    text-align: center;
    display: none;
    z-index: 200;
  }

  /* === –û—Ç–∑—ã–≤—ã –∫–ª–∏–µ–Ω—Ç–æ–≤ === */
  #commentsPanel {
    position: absolute;
    top: 50px;
    right: 10px;
    width: 300px;
    max-height: 400px;
    overflow-y: auto;
    background: rgba(0,0,0,0.5);
    color: #fff;
    border-radius: 10px;
    padding: 10px;
    font-size: 14px;
    display: none;
    z-index: 150;
  }

  /* === –ù–∞—Å—Ç—Ä–æ–π–∫–∏ === */
  #settingsPanel {
    position: absolute;
    top: 10px;
    right: 10px;
    display: flex;
    gap: 10px;
    z-index: 100;
  }
  #settingsPanel img {
    width: 50px;
    cursor: pointer;
    transition: transform 0.2s;
  }
  #settingsPanel img:hover { transform: scale(1.1); }
</style>
</head>
<body>

<!-- –í–µ—Ä—Ö–Ω—è—è –ø–∞–Ω–µ–ª—å: –¥–µ–Ω—å–≥–∏, –∑–≤–µ–∑–¥—ã -->
<div id="topBar">
  <div id="money">$0</div>
  <div id="stars">1‚úÆ</div>
</div>

<!-- –ü–∞–Ω–µ–ª—å –∫–Ω–æ–ø–æ–∫ –¥–µ–π—Å—Ç–≤–∏–π -->
<div id="actionButtons">
  <img id="acceptBtn" src="accept.png" alt="Accept">
  <img id="declineBtn" src="decline.png" alt="Decline">
</div>

<!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ -->
<div id="settingsPanel">
  <img id="settingsBtn" src="SettingsEng.png" alt="Settings">
  <img id="commentsBtn" src="comment.png" alt="Comments">
</div>

<!-- –ü–∞–Ω–µ–ª—å –æ—Ç–∑—ã–≤–æ–≤ -->
<div id="commentsPanel"></div>

<!-- –í—Å–ø–ª—ã–≤–∞—é—â–µ–µ –æ–∫–Ω–æ –∞—á–∏–≤–æ–∫ -->
<div id="achievementPopup"></div>

<!-- –ö–ª–∏–µ–Ω—Ç -->
<img id="clientImg" class="client" src="capy.png" alt="Client">

<!-- –û–±–ª–∞—á–∫–æ –∑–∞–∫–∞–∑–∞ -->
<div id="orderBubble" class="orderBubble"></div>

<audio id="clickSound" src="click.wav"></audio>
<audio id="achievementSound" src="achievement.wav"></audio>
<audio id="musicSound" src="music4game.mp3" loop></audio>

<script>
  // ====== LOCALSTORAGE INITIALIZATION ======
  if(!localStorage.cafeMoney) localStorage.cafeMoney = 0;
  if(!localStorage.cafeStars) localStorage.cafeStars = 1;
  if(!localStorage.language) localStorage.language = 'eng';
  if(!localStorage.achievements) localStorage.achievements = JSON.stringify([]);
  if(!localStorage.comments) localStorage.comments = JSON.stringify([]);

  // ====== VARIABLES ======
  let money = parseInt(localStorage.cafeMoney);
  let stars = parseInt(localStorage.cafeStars);
  let clientsServed = 0;
  let currentClient = null;
  let currentOrder = null;

  const clientImg = document.getElementById('clientImg');
  const orderBubble = document.getElementById('orderBubble');
  const moneyDiv = document.getElementById('money');
  const starsDiv = document.getElementById('stars');
  const acceptBtn = document.getElementById('acceptBtn');
  const declineBtn = document.getElementById('declineBtn');
  const commentsPanel = document.getElementById('commentsPanel');
  const commentsBtn = document.getElementById('commentsBtn');
  const achievementPopup = document.getElementById('achievementPopup');
  const clickSound = document.getElementById('clickSound');
  const achievementSound = document.getElementById('achievementSound');
  const musicSound = document.getElementById('musicSound');

  // ====== MUSIC ======
  musicSound.volume = 0.5;
  musicSound.play().catch(()=>{document.body.addEventListener('click', ()=>musicSound.play(),{once:true});});

  // ====== UTILITY FUNCTIONS ======
  function updateTopBar() {
    moneyDiv.textContent = `$${money}`;
    starsDiv.textContent = stars+'‚úÆ';
  }

  function generateClient() {
    // –†–∞–Ω–¥–æ–º–Ω–∞—è –∫–∞–ø–∏–±–∞—Ä–∞ –∏ –∞–∫—Å–µ—Å—Å—É–∞—Ä
    const gender = Math.random() < 0.5 ? 'boy' : 'girl';
    const imgSrc = gender==='boy' ? 'capy.png' : 'capygirl.png';
    const accessories = ['hat','dress','jacket','jewelry',''];
    let acc = accessories[Math.floor(Math.random()*accessories.length)];
    currentClient = {gender,imgSrc,accessory:acc};
    clientImg.src = imgSrc;
    clientImg.classList.remove('show');
    setTimeout(()=>{clientImg.classList.add('show');},100);
    // –†–∞–Ω–¥–æ–º–Ω–æ–µ –∏–º—è
    currentClient.name = 'C'+Math.floor(Math.random()*10000);
    // –°–ª—É—á–∞–π–Ω—ã–π –∑–∞–∫–∞–∑ (–ø—Ä–æ—Å—Ç–æ –ø—Ä–∏–º–µ—Ä)
    const orders = ['matcha','tea','coffee'];
    currentOrder = orders[Math.floor(Math.random()*orders.length)];
    orderBubble.textContent = currentOrder;
    orderBubble.classList.remove('show');
    setTimeout(()=>{orderBubble.classList.add('show');},200);
  }

  function addComment(name, starsCount, text){
    let comments = JSON.parse(localStorage.comments);
    comments.push({name,starsCount,text});
    localStorage.comments = JSON.stringify(comments);
  }

  function showAchievement(text){
    achievementPopup.textContent = text;
    achievementPopup.style.display='block';
    achievementSound.play();
    setTimeout(()=>{achievementPopup.style.display='none';},3000);
  }

  function acceptOrder(){
    clickSound.play();
    money += 50; // –º–æ–∂–Ω–æ –º–µ–Ω—è—Ç—å –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∞—á–∏–≤–æ–∫
    clientsServed++;
    if(clientsServed%10===0) showAchievement(`üéâ –û–±—Å–ª—É–∂–∏–ª–∏ ${clientsServed} –∫–ª–∏–µ–Ω—Ç–æ–≤! +200$`);
    addComment(currentClient.name,5,`–û—Ç–ª–∏—á–Ω–æ! –ó–∞–∫–∞–∑ ${currentOrder} –≤—ã–ø–æ–ª–Ω–µ–Ω.`);
    localStorage.cafeMoney = money;
    updateTopBar();
    generateClient();
  }

  function declineOrder(){
    clickSound.play();
    addComment(currentClient.name,1,"–ù–µ –ø—Ä–∏–Ω—è–ª–∏ –∑–∞–∫–∞–∑. –î–µ–Ω—å–≥–∏ –Ω–µ –¥–∞–Ω—ã.");
    generateClient();
  }

  // ====== BUTTON EVENTS ======
  acceptBtn.addEventListener('click', acceptOrder);
  declineBtn.addEventListener('click', declineOrder);
  commentsBtn.addEventListener('click', ()=>{commentsPanel.style.display = commentsPanel.style.display==='block'?'none':'block';});

  // ====== INITIALIZE ======
  updateTopBar();
  generateClient();

</script>
</body>
</html>
